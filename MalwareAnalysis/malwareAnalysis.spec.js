import { simulate } from './malwareAnalysis'

describe('Malware analysis', () => {
    const small_sets = [
        [ [ 19 ] ],
        [ [ 19, 2 ] ],
        [ [ 19, 2, 0 ] ]
    ]

    test('Empty test', () => {
        var result = simulate([])
        expect(result).toStrictEqual([])
    }),
    test.each(small_sets)('Sets so small should return same set', (set) => {
        var result = simulate(set)
        expect(result).toStrictEqual(set)
    }),
    test('Set long enough for check on the left, no change', () => {
        const input = [ 19, 2, 0, 87 ]
        var result = simulate(input)
        expect(result).toStrictEqual(input)
    }),
    test('Set long enough for check on the left, change', () => {
        var result = simulate([2, 0, 87, 1])
        expect(result).toStrictEqual([2, 0, 87, 0])
    }),
    test('Solve sample', () => {
        var result = simulate([19, 2, 0, 87, 1, 40, 80, 77, 77, 77, 77])
        expect(result).toStrictEqual([19, 0, 0, 87, 0, 0, 0, 77, 77, 0, 0])
    })
})